// Generated by CoffeeScript 1.6.3
(function() {
  var ChatCtrl;

  ChatCtrl = function($scope) {
    var client;
    client = io.connect('http://127.0.0.1');
    client.emit('user', "user" + ((new Date()).getTime()));
    client.on('user', function(users) {
      $scope.users = users;
      return $scope.$apply();
    });
    client.on('msg', function(msg) {
      $scope.msgs.push(msg);
      return $scope.$apply();
    });
    $scope.msgs = [];
    $scope.sendMsg = function() {
      var msg;
      msg = $scope.msg;
      if ((msg != null ? msg.length : void 0) > 0) {
        client.emit('msg', msg);
        return $scope.msg = '';
      }
    };
    $scope.sendMsgWhenReturn = function(e) {
      if (e.keyCode === 13) {
        return $scope.sendMsg();
      }
    };
    return $scope.changeName = function() {
      return client.emit('user', $scope.me);
    };
  };

  angular.module('chat', ['directive']).controller('ChatCtrl', ['$scope', ChatCtrl]);

}).call(this);
